import{d as B,a as F,r as D,L as x,o as L,e as V,E as d,x as E,D as O,g as l,h as s,l as c,p,n as I,j as C,z as n,F as q,t as z,v as r,y as v,_ as R}from"./index-lJ9Ej1SP.js";const $={class:"order-detail-container"},j={key:0,class:"loading"},P={key:1,class:"not-found"},U={key:2,class:"order-detail"},G={class:"page-header"},H={class:"order-info"},J={class:"order-header"},K={class:"order-number"},Q={class:"value"},W={class:"order-date"},X={class:"value"},Y={class:"order-status"},Z={class:"value"},ss={key:0,class:"user-info"},ts={class:"info-item"},es={class:"value"},os={key:0,class:"info-item"},as={class:"value"},ns={class:"items-section"},ls={class:"items-table"},rs=B({__name:"OrderDetail",setup(ds){const _=V(),u=E(),g=F(),e=D(null),i=D(!0),M=x(()=>g.isAdmin),N=x(()=>e.value?e.value.orderItems||e.value.items||[]:[]);L(async()=>{if(console.log("OrderDetail组件已挂载"),console.log("路由参数:",_.params),!g.isLoggedIn){d.warning("请先登录"),u.push("/login");return}const o=_.params.id;if(!o){d.error("订单ID不存在"),u.push(M.value?"/admin":"/orders");return}console.log("正在获取订单详情，ID:",o);try{i.value=!0;const t=await O.get(`https://smart-book-city.onrender.com/api/orders/${o}`);console.log("订单详情API响应:",t.data),t.data?e.value=t.data:d.error("订单不存在")}catch(t){console.error("获取订单详情失败:",t),d.error("获取订单详情失败")}finally{i.value=!1}});const S=o=>new Date(o).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),T=o=>({0:"待付款",1:"已完成"})[o]||`未知状态(${o})`,w=o=>({0:"warning",1:"success"})[o]||"",m=()=>{u.back()};return(o,t)=>{const y=I("el-button"),A=I("el-tag");return r(),l("div",$,[i.value?(r(),l("div",j,t[0]||(t[0]=[s("p",null,"加载中...",-1)]))):e.value?(r(),l("div",U,[s("div",G,[t[4]||(t[4]=s("h2",null,"订单详情",-1)),c(y,{type:"primary",onClick:m},{default:p(()=>t[3]||(t[3]=[v("返回")])),_:1})]),s("div",H,[s("div",J,[s("div",K,[t[5]||(t[5]=s("span",{class:"label"},"订单号:",-1)),s("span",Q,n(e.value.orderNumber),1)]),s("div",W,[t[6]||(t[6]=s("span",{class:"label"},"下单时间:",-1)),s("span",X,n(S(e.value.orderDate)),1)]),s("div",Y,[t[7]||(t[7]=s("span",{class:"label"},"订单状态:",-1)),s("span",Z,[c(A,{type:w(e.value.status)},{default:p(()=>[v(n(T(e.value.status)),1)]),_:1},8,["type"])])])]),e.value.user?(r(),l("div",ss,[t[10]||(t[10]=s("h3",null,"用户信息",-1)),s("div",ts,[t[8]||(t[8]=s("span",{class:"label"},"用户名:",-1)),s("span",es,n(e.value.user.username),1)]),e.value.user.email?(r(),l("div",os,[t[9]||(t[9]=s("span",{class:"label"},"邮箱:",-1)),s("span",as,n(e.value.user.email),1)])):C("",!0)])):C("",!0),s("div",ns,[s("table",ls,[t[11]||(t[11]=s("thead",null,[s("tr",null,[s("th",null,"书籍名称"),s("th",null,"作者"),s("th",null,"单价"),s("th",null,"数量"),s("th",null,"总计")])],-1)),s("tbody",null,[(r(!0),l(q,null,z(N.value,a=>{var b,f,h,k;return r(),l("tr",{key:a.id},[s("td",null,n(a.bookTitle||((b=a.book)==null?void 0:b.title)),1),s("td",null,n(a.bookAuthor||((f=a.book)==null?void 0:f.author)),1),s("td",null,"¥"+n((a.price||((h=a.book)==null?void 0:h.price)||0).toFixed(2)),1),s("td",null,n(a.quantity),1),s("td",null,"¥"+n(((a.price||((k=a.book)==null?void 0:k.price)||0)*a.quantity).toFixed(2)),1)])}),128))])])])])])):(r(),l("div",P,[t[2]||(t[2]=s("h2",null,"订单不存在",-1)),c(y,{type:"primary",onClick:m},{default:p(()=>t[1]||(t[1]=[v("返回")])),_:1})]))])}}}),is=R(rs,[["__scopeId","data-v-b7b1d105"]]);export{is as default};
