import{d as T,a as w,r as D,L as B,o as F,e as L,E as d,x as V,D as q,g as l,l as i,h as s,p,n as x,j as I,z as n,F as E,t as O,v as r,y as v,_ as z}from"./index-lJ9Ej1SP.js";import{A as R}from"./AdminNavbar-QXUN9gnu.js";const $={class:"admin-order-detail-container"},j={class:"content-container"},P={key:0,class:"loading"},U={key:1,class:"not-found"},G={key:2,class:"order-detail"},H={class:"page-header"},J={class:"order-info"},K={class:"order-header"},Q={class:"order-number"},W={class:"value"},X={class:"order-date"},Y={class:"value"},Z={class:"order-status"},ss={class:"value"},ts={key:0,class:"user-info"},es={class:"info-item"},os={class:"value"},as={class:"info-item"},ns={class:"value"},ls={key:0,class:"info-item"},rs={class:"value"},ds={class:"items-section"},is={class:"items-table"},us=T({__name:"AdminOrderDetail",setup(cs){const _=L(),u=V(),m=w(),e=D(null),c=D(!0),A=B(()=>e.value?e.value.orderItems||e.value.items||[]:[]);F(async()=>{if(console.log("AdminOrderDetail组件已挂载"),console.log("路由参数:",_.params),!m.isLoggedIn||!m.isAdmin){d.warning("请先登录管理员账号"),u.push("/login");return}const o=_.params.id;if(!o){d.error("订单ID不存在"),u.push("/admin");return}console.log("正在获取订单详情，ID:",o);try{c.value=!0;const t=await q.get(`https://smart-book-city.onrender.com/api/orders/${o}`);console.log("订单详情API响应:",t.data),t.data?e.value=t.data:d.error("订单不存在")}catch(t){console.error("获取订单详情失败:",t),d.error("获取订单详情失败")}finally{c.value=!1}});const C=o=>new Date(o).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),M=o=>({0:"待付款",1:"已完成"})[o]||`未知状态(${o})`,N=o=>({0:"warning",1:"success"})[o]||"",g=()=>{u.push({path:"/admin",query:{activeMenu:"orders"}})};return(o,t)=>{const y=x("el-button"),S=x("el-tag");return r(),l("div",$,[i(R),s("div",j,[c.value?(r(),l("div",P,t[0]||(t[0]=[s("p",null,"加载中...",-1)]))):e.value?(r(),l("div",G,[s("div",H,[t[4]||(t[4]=s("h2",null,"订单详情",-1)),i(y,{type:"primary",onClick:g},{default:p(()=>t[3]||(t[3]=[v("返回订单管理")])),_:1})]),s("div",J,[s("div",K,[s("div",Q,[t[5]||(t[5]=s("span",{class:"label"},"订单号:",-1)),s("span",W,n(e.value.orderNumber),1)]),s("div",X,[t[6]||(t[6]=s("span",{class:"label"},"下单时间:",-1)),s("span",Y,n(C(e.value.orderDate)),1)]),s("div",Z,[t[7]||(t[7]=s("span",{class:"label"},"订单状态:",-1)),s("span",ss,[i(S,{type:N(e.value.status)},{default:p(()=>[v(n(M(e.value.status)),1)]),_:1},8,["type"])])])]),e.value.user?(r(),l("div",ts,[t[11]||(t[11]=s("h3",null,"用户信息",-1)),s("div",es,[t[8]||(t[8]=s("span",{class:"label"},"用户ID:",-1)),s("span",os,n(e.value.user.id),1)]),s("div",as,[t[9]||(t[9]=s("span",{class:"label"},"用户名:",-1)),s("span",ns,n(e.value.user.username),1)]),e.value.user.email?(r(),l("div",ls,[t[10]||(t[10]=s("span",{class:"label"},"邮箱:",-1)),s("span",rs,n(e.value.user.email),1)])):I("",!0)])):I("",!0),s("div",ds,[s("table",is,[t[12]||(t[12]=s("thead",null,[s("tr",null,[s("th",null,"书籍名称"),s("th",null,"作者"),s("th",null,"单价"),s("th",null,"数量"),s("th",null,"总计")])],-1)),s("tbody",null,[(r(!0),l(E,null,O(A.value,a=>{var f,h,b,k;return r(),l("tr",{key:a.id},[s("td",null,n(a.bookTitle||((f=a.book)==null?void 0:f.title)),1),s("td",null,n(a.bookAuthor||((h=a.book)==null?void 0:h.author)),1),s("td",null,"¥"+n((a.price||((b=a.book)==null?void 0:b.price)||0).toFixed(2)),1),s("td",null,n(a.quantity),1),s("td",null,"¥"+n(((a.price||((k=a.book)==null?void 0:k.price)||0)*a.quantity).toFixed(2)),1)])}),128))])])])])])):(r(),l("div",U,[t[2]||(t[2]=s("h2",null,"订单不存在",-1)),i(y,{type:"primary",onClick:g},{default:p(()=>t[1]||(t[1]=[v("返回")])),_:1})]))])])}}}),_s=z(us,[["__scopeId","data-v-00ee2929"]]);export{_s as default};
